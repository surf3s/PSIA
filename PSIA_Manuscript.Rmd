---
title: Introducing Platform Surface Interior Angle (PSIA) and Its Role in Flake Formation,
  Size and Shape
author:
- affiliation: MPI
  corresponding: mcpherron@eva.mpg.de
  email: mcpherron@eva.mpg.de
  name: Shannon P. McPherron
- affiliation: UPENN
  email: aylarabd@sas.upenn.edu
  name: Aylar Abdolahzadeh
- affiliation: [NMSA, MPI]
  email: will.archer@nasmus.co.za
  name: Will Archer
- affiliation: [LMU, CRCAS]
  email: a.chan@lmu.de
  name: Annie Chan
- affiliation: Leiden
  email: igor.djakovic@uq.net.au
  name: Igor Djakovic
- affiliation: MPI
  email: tamara_dogandzic@eva.mpg.de
  name: Tamara Dogandžić
- affiliation: CNJ
  email: leaderg@tcnj.edu
  name: George M. Leader
- affiliation: Tubingen
  email: li.li@uni-tuebingen.de
  name: Li Li
- affiliation: UOW
  email: samlin@uow.edu.au
  name: Sam Lin
- affiliation: HARVARD
  email: matthewmagnani@g.harvard.edu
  name: Matthew Magnani
- affiliation: Tubingen
  email: jonathanscott.reeves@gmail.com
  name: Jonathan Reeves
- affiliation: MPI
  email: zeljko_rezek@eva.mpg.de
  name: Zeljko Rezek
- affiliation: MPI
  email: marcel_weiss@eva.mpg.de
  name: Marcel Weiss
address:
- address: Department of Human Evolution, Max Planck Institute for Evolutionary Anthropology,
    Leipzig, Germany
  code: MPI
- address: Department of Anthropology, University of Pennsylvania, Philadelphia, Pennsylvania,
    United States of America
  code: UPENN
- address: Department of Archaeology and Anthropology, National Museum, Bloemfontein, South Africa
  code: NMSA
- address: Department of Archaeology, University of Leiden, Leiden, The Netherlands
  code: Leiden
- address: Department of Early Prehistory and Quaternary Ecology, Eberhard Karls University
    of Tübingen, Tübingen, Germany
  code: Tubingen
- address: Centre for Archaeological Science, School of Earth, Atmospheric and Life
    Sciences, University of Wollongong, Wollongong, Australia
  code: UOW
- address:  Department of Sociology and Anthropology, The College of New Jersey, Ewing, New Jersey,
    United States of America
  code: CNJ
- address: Department of Asian Studies, Ludwig-Maximilians-Universität München, Munich, Germany
  code: LMU
- address: Department of Anthropology, Harvard University, Cambridge, Massachusetts, United States of America
  code: HARVARD
- address: Centre de Recherche sur les Civilisations de l’Asie Orientale, Paris, France
  code: CRCAS
output:
  pdf_document: rticles::plos_article
  word_document: default
csl: plos.csl
header-includes:
- \usepackage{lineno}
- \usepackage{setspace}\doublespacing
bibliography: bibliography.bib
abstract: |
  Four ways archaeologists have tried to gain insights into how flintknapping creates lithic variability are fracture mechanics, controlled experimentation, replication and attribute studies of lithic assemblages.  Fracture mechanics has the advantage of drawing more directly on first principles derived from physics and material sciences, but its relevance to controlled experimentation, replication and lithic studies more generally has been limited.  Controlled experiments have the advantage of being able to isolate and quantify the contribution of individual variables to knapping outcomes, and the results of these experiments have provided models of flake formation that when applied to the archaeological record of flintknapping have provided insights into past behavior. Here we develop a linkage between fracture mechanics and the results of previous controlled experiments to increase their combined explanatory and predictive power.  We do this by documenting the influence of Herztian cone formation, a constant in fracture mechanics, on flake platforms.  We find that the platform width is a function of the Hertzian cone constant angle and the geometry of the platform edge.  This finding strengthens the foundation of one of the more influential models emerging from the controlled experiments.  With additional work, this should make it possible to merge more of the experimental results into a more comprehensive model of flake formation.
---

<!--
This is the rMarkdown document used to create the manuscript
and its figures/tables.

It requires:
1) the png, tidyverse, retistruct, gridExtra and ggpubr libraries,
2) the data sets and two figures (datasets.zip),
3) the citations included here (bibliography.bib - also found in datasets.zip),
4) and the format file (plos.csl - also found in datasets.zip).
To compile this markdown document, place all these files in one folder and
either build with the rStudio interface or issue the following command:
rmarkdown::render('PSIA_Manuscript.rmd')

-->

```{r setup_markdown, include=FALSE}

knitr::opts_chunk$set(tidy = FALSE, echo = FALSE, warning = FALSE, message = FALSE, comment = NA, cache = FALSE)

# To have the figures embedded in this document, set this to FALSE
tiff_figures = TRUE

```

```{r setup_analysis}

library(tidyverse)
library(retistruct)
library(gridExtra)
library(png)

# This library is used only for Figure 10
# to have a legend across the bottom.
library(ggpubr)

# Some functions for dealing with vectors and angles
normals = function(xyz) {
  l = vector_length(xyz)
  return(cbind(ifelse(l != 0, (xyz[,1]) / l, 0),
               ifelse(l != 0, (xyz[,2]) / l, 0),
               ifelse(l != 0, (xyz[,3]) / l, 0)))  }

vector_length = function(xyz) return( sqrt(xyz[,1]^2 + xyz[,2]^2 + xyz[,3]^2) )

rad2deg = function(angles) return(angles / pi * 180)

dot_product = function(v1, v2) return(v1[,1] * v2[,1] + v1[,2] * v2[,2] + v1[,3] * v2[,3])

# Get the Dibble data sets.
dibble_inc_bevel = readRDS('Dibble_flakes_including_bevel.RDS')
dibble = readRDS('Dibble_flakes_no_bevel.RDS')

# Get the Dibble flake re-measurement dataset (those re-measured by hand)
dibble_remeasured = readRDS('Dibble_flakes_remeasurements.RDS') %>%
  mutate(psia_trig = rad2deg(acos((PV1 ^ 2 + PV2 ^ 2 - PW ^ 2) / (2 * PV1 * PV2)))) %>%
  filter(!is.na(psia_trig))

# Get the Campagne data set
campagne = readRDS('campagne_attributes.RDS')
campagne_landmarks = readRDS('campagne_landmarks.RDS')

# Calculate the PSIA from the point of percussion and two platform width landmarks
point_of_percussion = t(campagne_landmarks[1,,])
edge_1 = t(campagne_landmarks[2,,]) - point_of_percussion
edge_2 = t(campagne_landmarks[3,,]) - point_of_percussion

# Add the PSIA to the attributes and also calculate and add a PW and PD
campagne$psia = rad2deg(acos(dot_product(normals(edge_1), normals(edge_2))))
campagne$pw = vector_length(edge_1 - edge_2)
campagne$pd = vector_length(point_of_percussion - t(campagne_landmarks[4,,]))

# Get the MPI dataset
MPI_flakes = readRDS('MPI_flakes.RDS')


# Get the outline of the Dibble core surface (semispherical)
core_outline = readRDS('Dibble_core_platform_outline.RDS')

# Get just the part that is struck
platform_edge = core_outline[core_outline[,2] < 11,]

# Fit a curve to it
dataset = data.frame(platform_edge)
names(dataset) = c('x','y')
curve = lm(y ~ poly(x, 2, raw = TRUE), data = dataset)

# Use this curve to now sample the edge at high resolution
curve_x = seq(-40, 40, length = 251)
curve_y = predict(curve, data.frame(x = curve_x))
min_y = min(curve_y)
curve_y = curve_y - min_y
curve_xy = cbind(curve_x, curve_y)

my_theme = theme_minimal()
my_theme = my_theme + theme(panel.grid.minor = element_blank())
my_theme = my_theme + theme(panel.grid.major.x = element_blank())

my_theme_smaller_font = my_theme + theme(axis.text = element_text(size = 8),
                                         axis.title = element_text(size = 9))

```

```{r figure_captions}

# All captions are composed here so that they can either be embedded or listed separately at the end of this document.
fig_captions = list(length = 12)
fig_captions[[1]] = "Illustration of several flake attributes discussed here.  On the left is a schematic semispherical core used in the Dibble and colleagues glass experiments.  On right is a schematic profile of the core through the point of percussion."
fig_captions[[2]] = "Left, an example of a semispherical glass core from the Dibble and colleagues experiments with landmarks on the platform outline.  Above right, those same landmarks plotted in XY space.  Below right, the core edge after fitting a polynominal curve to the XY landmarks."
fig_captions[[3]] = "Distribution of estimated PSIA based on the Dibble glass flakes."
fig_captions[[4]] = "PW, PD, EPA and weight against the estimated PSIA based on the Dibble glass flakes."
fig_captions[[5]] = "AOB against the estimated platform surface interior angles based on the Dibble glass flakes."
fig_captions[[6]] = "The actual platform depth to platform width data from the Dibble glass core flakes and the estimated platform width using the average platform surface interior angle calculated previously."
fig_captions[[7]] = "A comparison of the estimated platform surface interior angle, this same angle as calculated from caliper measurements, and this same angle measured with a goniometer.  All measures are in degrees."
fig_captions[[8]] = 'The distributions of platform surface interior angle as directly measured with a goniometer and as calculated from caliper measurements.'
fig_captions[[9]] = "Distribution of PSIA in the Campagne data set color coded by percussion type."
fig_captions[[10]] = "PSIA as a function of platform width, platform depth, and EPA in the experimental flake collection.  Color coding is the same as in Figure 8."
fig_captions[[11]] = 'Distribution of platform surface interior angle in the MPI flakes dataset as measured by a digital goniometer.'
fig_captions[[12]] = "Platform depth to platform width including beveled flakes (red) and non-beveled flakes (black) (top).  Estimated points in blue are the same beveled flakes but with the platform depth predicted using the average PSIA and their actual platform width.  At the bottom, the actual flake weight is compared to the predicted flake weight based on an EPA-PD model for non-beveled flakes (points in black).  The predicted weight using the actual (w/o PSIA) and the modeled (with PSIA) platform depths for the beveled flakes are then plotted as well in red and blue respectively."
  
```

# Introduction

There is considerable literature dedicated to understanding how flakes form.  This understanding has come from work following several broad approaches including fracture mechanics (e.g. [@cotterell_essential_1985; @cotterell_formation_1987; @cotterell_mechanics_1979; @speth_mechanical_1972]), controlled experiments (e.g. [@speth_experimental_1974; @speth_miscellaneous_1975; @speth_role_1981; @dibble_effect_1995; @dibble_introducing_2009-1; @dibble_new_1981-1; @pelcin_effect_1997; @pelcin_effect_1997-1; @pelcin_formation_1997]), replicative experiments (e.g. [@davis_quantifying_1998; @eren_why_2012; @mourre_early_2010]), and attribute analysis of archaeological assemblages.  These approaches each have their own strengths and weaknesses; however, one way to think about the differences among them is in the directionality of inference.  Fracture mechanics starts with first principles, or laws drawn from physics and material sciences in particular, concerning how fractures should form in brittle solids.  These are then used to make predictions, typically with explicit mathematical models, about how flakes should look (size and shape) under varying conditions of force application and solid material properties.  These predictions are then typically tested experimentally.  To the contrary, controlled and replicative experiments and studies of actual lithic assemblages look at empirical regularities in flake size and shape under varying conditions of core preparation and flaking (where the core is struck, the hammer type, how the platform is prepared, the angle of strike, etc.).  The observed outcomes are then summarized as statistical models of flake formation.  From these models one can try to infer first principles, but for reasons discussed next, this is usually not done.  All of these approaches to understanding flake formation are, of course, valid and useful.  Ideally, what is learned from actually doing (experiments) and what is learned from knowing how it should work in principle (fracture mechanics) inform each other in an iterative loop.  

Understanding first principles causality from statistical modeling, however, is challenging.  McElreath @mcelreath_sizing_2018 gives the example of trying to understand the physics behind race cars by measuring their attributes.  Knowing the speed and handling characteristics of each car, eventually the right things could be measured on each car to build statistical models with enough predictive power to know how a new car might perform in a race, but it would be quite difficult to infer the general physical concepts (and laws) like torque, angular momentum, friction, aerodynamics, conservation of energy, etc. from these statistical models.  Of course, with prior knowledge of the physics, finding the right attributes to measure on the cars and statistical modeling are more quickly and accurately done.  This is important because even when the physical laws are known, modeling them directly can be prohibitively complex or computationally expensive (e.g. air resistance) whereas experiments and statistical models can more efficiently arrive at useable solutions.

The same is true of studies of flake formation and the role of fracture mechanics within it.  Fracture mechanics itself is a longstanding and widely-applied field of study, but its practical application has been extremely limited in our field, with the best examples coming from the papers of Cotterell and Kamminga [@cotterell_formation_1987; @cotterell_mechanics_1979] and of Speth [@speth_mechanical_1972; @speth_experimental_1974].  These papers start with the physics of fracture mechanics in brittle solids to then explain how flakes are formed and, therefore, why they vary.  Some attributes, like the bulb of percussion, are more easily accounted for directly in fracture mechanics (e.g. Hertzian cone formation), whereas for other attributes, like flake size and shape, the conceptual and mathematical frameworks are provided by fracture mechanics.  However, as with the just mentioned example of air resistance, translating the physics of how flakes are formed into a workable model that can predict flake size and shape given the relevant parameters (e.g. core shape, angle of blow, force of blow, etc.) has not come to pass (cf. @speth_mechanical_1972), and it may not come to pass any time soon.

So instead, while some papers on controlled experiments in flake formation may cite studies from fracture mechanics, their approaches are all based on statistical modeling of the empirical relationships between variables of flaking and flake outcomes.  Speth's work on this topic is a good example.  His 1972 paper uses fracture mechanics to derive a formula to predict flake size which is then tested against a set of actual flakes from a prehistoric site.  By 1975 and again in 1981, Speth had moved to experimental approaches (ball bearings on glass) and the connection back to fracture mechanics had all but disappeared.  Dibble @dibble_new_1981-1 goes further and dismisses fracture mechanics from the start as nearly irrelevant.  Instead of looking to fracture mechanics for insights into what to study, experimental studies are being informed by replicative knappers and observations on how actual lithic assemblages vary.  Dibble [@dibble_new_1981-1; @dibble_platform_1997] is explicit in stating that his experimental research is based on what knappers would have been able to control.  In these experiments, coming back to the race car analogy, we are carefully building cars controlling for engine size, wheel configurations, foils, etc., things that are generally thought to be important for making a car go fast, and then measuring their speeds.  Again, though, because it is also difficult to go in the other direction (from statistical modeling back to first principles), the controlled experiment papers have not produced a general model of how flakes form.  Instead, we have a series of statistical models that are difficult to relate to one another (e.g. @magnani_flake_2014-1).  Part of the difficulty stems from the fact that different knapping variables are likely related in complex ways during flake formation, yet their effects on flake variation are limited to a similar set of size and shape attributes. For instance, Magnani et al. [@magnani_flake_2014-1] showed that changing the angle of blow, the location of percussion and hammer hardness all result in similar flake attribute variation. While regression models can capture the influence of these individual knapping factors, reconciling them into a causal sequence of flake formation remains challenging without the guidance of a general model.

```{r fig1, fig.cap = fig_captions[[1]], fig.height = 2, fig.width = 5, out.width = '350px'}

if (tiff_figures) cat('[place Figure 1 here]')
if (!tiff_figures) knitr::include_graphics('Figure_01.png')

```

The strongest and most influential model derived from controlled experiments is the exterior platform angle and platform depth (EPA-PD) model.  The EPA-PD model states that flake size (weight) is primarily a function of two important variables: exterior platform angle (EPA) and platform depth (PD) (Figure 1).  Increasing either of these variables will increase flake size, but the relationship between the two is geometric such that at higher values of EPA changes in PD have a greater effect on flake size.  The EPA-PD model has been replicated in multiple ways, including experiments in the material sciences [@dibble_new_1981-1; @dibble_effect_1995; @speth_miscellaneous_1975; @speth_role_1981; @chai_edge_2007; @dogandzic_results_2020] and in actual lithic assemblages (e.g. [@dibble_platform_1997; @lin_utility_2013-1; @rezek_two_2018]).  It is also argued that in certain conditions, EPA-PD has a stronger effect on flake size and shape than does core surface morphology [@pelcin_effect_1997; @rezek_relative_2011-1].  The EPA-PD model of flake formation, however, is constrained in what it can explain.  For instance, beveled flakes, where the volume behind the platform is thinned, are not easily included into the model @leader_effects_2017.  Beveled flakes are typically larger (weight) than the EPA-PD models predicts given their lower platform depths.  The EPA-PD model also  does not explain why flake size and shape change with varying angles of blow and platform shape [@clarkson_estimating_2011-1; @dibble_introducing_2009-1; @magnani_flake_2014-1].  It also does not account for flake width, which is obviously a major component of shape.  It is worth noting that while the percentage of variability in weight explained by the EPA-PD model (R^2^) is typically high in the Dibble glass experiments, it is far lower in actual lithic assemblages [@clarkson_estimating_2011-1].  It is low enough that its utility for measuring retouch intensity (i.e. knowing how much mass has been removed from a flake through retouch) is limited [@davis_quantifying_1998; @shott_flake_2000; @dogandzic_edge_2015; @hiscock_generalization_2010].  As a result, there have been various proposals to improve the statistical modeling of flake weight (or size) from different sets of measures (e.g. [@archer_geometric_2018; @Braun2010; @dogandzic_edge_2015; @muller_estimating_2014]).  Again, though, without a general model, it is not really clear why one measurement technique should work better than another.  Because of this, the success of these models is measured by the amount of empirical variation the models can account for (i.e. R^2^ values) rather than against theoretical predictions.  This approach reflects the fundamental issue that our knowledge of how flake formation works is still too limited to be translated into measurable attributes.  Instead, the majority of the lithic attributes commonly measured by archaeologists are derived from intuitive observations through actualistic flintknapping (i.e., when we do x, flakes tend to show y).  As Speth [@speth_mechanical_1972, pp. 34-36] noted nearly a half century ago, how or even whether these attributes are indeed meaningful for explaining flake variation are typically not justified *a priori* by theoretical models of flake formation. 

Here we propose to build on the EPA-PD model by 1) switching the focus from variables controlled by the knapper to variables that might be more directly related to flake initiation and formation and by 2) drawing insights from the fracture mechanics literature.  In particular, we start with the principle that the Hertzian cone, the angle of which is known from fracture mechanics to be a constant for a given raw material, has a measurable impact on flake formation.

When a core is struck, the force of impact begins to produce a Hertzian cone or “cone crack” at the point of percussion (see Figure 1B). The Hertzian cone is the characteristic feature of Hertzian fracture and is produced when a hard indenter is pressed onto the flat surface of a brittle solid [@chen_contact_1995; @frank_theory_1967; @kocer_angle_1998; @lawn_computer_1974; @roesler_brittle_1956]. In three dimensions it forms a truncated cone below the impact surface (see Figure 1B). In archaeology, Hertzian fracture is often referred to as conchoidal fracture.  While the size of the Hertzian cone is dependent on variables such as the indenter’s radius, the impact velocity and the fracture toughness of the brittle solid, the cone angle remains unchanged [@chen_influence_1989]. The Hertzian cone angle (sometimes referred to as the 'included angle' in fracture mechanics literature) is the apex angle of the Hertzian cone. Though the orientation of the Hertzian cone can be altered by changing the of angle of blow [@akimune_oblique_1990; @chaudhri_dynamic_2015; @chen_influence_1989; @lawn_computer_1974], the apex angle remains constant for a given raw material type [@fischer-cripps_introduction_2007]. A number of fracture mechanics studies have demonstrated that the Hertzian cone angle is approximately 136° for soda lime glass [@kocer_angle_1998; @lawn_computer_1974; @roesler_brittle_1956], the type of glass used by Dibble and colleagues for their experiments. This value is also reported in Cotterell and Kamminga [@cotterell_formation_1987].  The cone crack grows as force is transferred to the core. Once the crack reaches a certain length, the crack’s propagation path will no longer be Hertzian. At this point, instead of propagating along the edges of the initial Hertzian cone, the crack continues almost parallel to the core surface to form a flake [@cotterell_essential_1985; @cotterell_formation_1987]. Although the Hertzian cone is only associated with the initial crack formation, the angle of the cone leaves a marked effect on the ventral surface of the flake near where it has been struck in the form of the bulb of percussion. 

Our prediction is that the constant Hertzian cone angle means that platform width of a given flake is a function of where the core is struck and where this angle intersects the platform edge.  To show this we present a new measure called platform surface interior angle (PSIA) formed by the point of percussion and the extent of the platform width (Figure 1A). We predict that this angle will be constant given that it directly follows from the constant of the Hertzian cone angle. If our prediction is correct, platform width (PW) can be  incorporated into the EPA-PD model and grounded in fracture mechanics via PSIA.  This model also has behavioral implications in that it may explain how the manipulation of the platform impacts flake morphology.

To test this model, we examine several sets of flakes, including flakes produced in the Dibble glass experiments and flakes from replication experiments, using several methods to measure the PSIA.  We find that the mean angle in all datasets, regardless of how it is measured, is the same (approximately 136 degrees) and quite consistent with above mentioned values for Hertzian cone formation [@cotterell_formation_1987].  There is some variability in the PSIA, and it is clear that this variability cannot be solely attributed to measurement error.  In the Dibble glass experiments, where key variables are controlled, there is some indication that the PSIA responds to the angle of blow.  Our finding is consistent with all of the empirical results of the Dibble experiments.  More importantly, PSIA explains some of the patterns in those data that previously were unaccounted for.  Once PSIA can be combined with the existing EPA-PD model, we may have a model for flake formation that can explain a larger portion of the variability we see in stone tool assemblages and that may allow for a closer link to predictions coming from fracture mechanics.

# Materials and Methods

We examine the platform surface interior angle in three different datasets.  First, we examine glass flakes (n = `r nrow(dibble)`) and cores coming from the Dibble controlled experiments in flake formation [@dibble_introducing_2009-1; @leader_effects_2017; @lin_utility_2013-1; @magnani_flake_2014-1; @rezek_relative_2011-1].  This dataset has the advantage that a number of potentially important variables are either controlled for or were measured.  These include the exterior platform angle, the angle of blow, the hammer type, raw material, and metrics such as platform thickness, platform width, flake length, width and thickness, and flake weight.  Hereafter this dataset is referred to as the *Dibble glass data*.  Second, we attempt to replicate the findings from the Dibble glass data by measuring the PSIA in a large (n = `r nrow(campagne)`) set of complete, unretouched flakes coming from 45 discrete reduction sequences produced in replicative experiments by three knappers who were naïve to the goals of this study.  These flakes were made with the intent of replicating various Middle and Upper Paleolithic core reduction strategies from the initial decortification of the core through to flake production and core maintenance [@brenet_elaboration_2009; @brenet_elaboracion_2011; @bourguignon_aproximacion_2011; @ortega_cordellat_produccion_2013].  These replicative experiments used nodules of high-quality Bergerac and Sénonien flint weighing from ~480–4100 g and coming from the southwest region of France [@jaubert_mousterien_2008].  For each of the flakes coming from these reduction series, the technology and the type of hammer (hard hammer, soft hammer and indirect percussion) are known.  Here we are interested in the hard hammer flakes because these are comparable to the Dibble hard hammer flakes, but we have included the soft hammer and indirect percussion flakes in the results presentation for discussion purposes.  Today these flakes are stored in Campagne, France, and hereafter this dataset is referred to as the *Campagne data* (see @archer_quantifying_nodate for additional details on the structure of this dataset).  Third, in addition, we measured a small set of flint flakes (n = `r nrow(MPI_flakes)`) produced at the Max Planck Institute for Evolutionary Anthropology in Leipzig, Germany, in the context of teaching, replication, and experimentation.  In this case, no details are known about how the flakes were produced (e.g. hammer types).  This set of flakes is used here only to test a method for measuring the PSIA.  Hereafter this dataset is referred to as the *MPI data*.

The methods used to measure the PSIA varied substantially between the three datasets for practical reasons given the types of data available to us and because we wanted to try different methods to begin to have some idea of how best to measure this angle in future studies.  First, for the Dibble glass data, we used the following procedure.  Dibble and colleagues used several core forms, but the first and most common type is what was called the semispherical core.  This core (reproduced here in Figure 2) looks like a loaf of bread with flat, squared off sides and back, and a curved or domed flaking surface.  An unworked example of this core type was scanned using an NextEngine 3D laser scanner.  The resulting mesh was then processed in R to rotate the platform to be perpendicular to the Z axis (or coincident with the XY plane).  The XY coordinates of the triangles forming the platform were then extracted from this model and a convex hull fit to this cloud of points to have the full outline of the platform on the Dibble semispherical cores (see Figure 2).  Next, we extracted just the portion of the outline that includes where flakes are struck from these cores, and we fit a polynomial curve to these points.  Using the formula for this curve, we created a series of equally spaced (in X) points along the platform edge (see Figure 2).  We then filtered the Dibble glass data to have only flakes made from the semispherical cores by hard hammer.  We include only flakes with a feather termination, and we exclude flakes coming from experiments on platform beveling [@leader_effects_2017] and so-called 'on-edge' core strikes [@magnani_flake_2014-1] (thereby arriving arriving at our sample of n = `r nrow(dibble)`).  Knowing that Dibble and colleagues tried to strike flakes from these cores at the center or peak of the core surface curvature, we use the platform depths reported for these flakes to position the point of percussion relative to the set of platform edge outline points described above.  Next, we find the symmetrical pair of platform edge outline points, one to the left and one to the right of the point of percussion, that yield a platform width equal to the reported platform width for each flake.  Finally, the PSIA is calculated (arc-cosine of the dot product of two normalize vectors) as the angle between the two line segments formed by the left platform width point and the point of percussion and the right platform point and the point of percussion.  In the results presented below, this angle is referred to as the *estimated* PSIA to indicate that this angle is not directly measured from the flakes themselves.

```{r fig2-core_outlines, fig.cap = fig_captions[[2]], fig.height = 2, fig.width = 3.5}

p = ggplot()
p = p + annotation_raster(readPNG('Figure_2a.png'), -Inf, Inf, -Inf, Inf)
p = p + my_theme
p1 = p + coord_fixed()

core_outline = data.frame(core_outline)
names(core_outline) = c('X','Y')

p = ggplot(core_outline, aes(X, Y))
p = p + geom_point(alpha = .5)
p = p + scale_x_continuous(limits = c(-40, 40), breaks = c(-40, 0, 40))
p = p + scale_y_continuous(limits = c(-5, 40), breaks = c(0, 20, 40))
p = p + xlab('')
p = p + my_theme 
p2 = p + coord_fixed()

platform_outline = data.frame(curve_xy)
names(platform_outline) = c('X','Y')

p = ggplot(platform_outline, aes(X, Y))
p = p + geom_point(size = .25)
p = p + scale_x_continuous(limits = c(-40, 40), breaks = c(-40, 0, 40))
p = p + scale_y_continuous(limits = c(-5, 40), breaks = c(0, 20, 40))
p = p + my_theme
p3 = p + coord_fixed()

if (tiff_figures) {
  cat('[place Figure 2 here]')
  tiff('figure_02.tif', res = 300, width = 5, height = 2, units = 'in') }

grid.arrange(p1, p2, p3, layout_matrix = rbind(c(1,2), c(1,3)))

if (tiff_figures) graphics.off()

```

We note that there are several potential sources of error in this method.  First, we are assuming that each flake was struck from the center of the core.  While this was the intention in the glass experiments, there is certainly some error associated with this.  Second, we are assuming that the flake fracture plane is parallel to the core surface and not twisted towards one lateral side or the other.  To the extent that either of these assumptions is invalid, it will impact the angle calculation.

To verify the angles computed in this way from the Dibble glass data, we also measure this angle directly with digital calipers and a goniometer on a subset of these flakes.  We use two methods of measurement to begin to test how best to measure the PSIA by hand.  In the first method, we measure the three sides of the triangle formed by the two platform width points and the point of percussion using digital calipers precise to .01 mm.  Using standard trigonometric formulas, we then calculate the interior angle of this triangle that corresponds to the PSIA as described above.  In the second method, we use a digital goniometer precise to 0.1 degrees to record this angle.  The joint of the goniometer is positioned at the point of percussion and the jaws positioned to cross the two platform width points.  Both of these methods come with possibilities for measurement error impacted by one's ability to pinpoint the point of percussion.  In the Dibble glass flakes, because the core edge is standardized, identifying the two platform width points is fairly straightforward.  However, in the goniometer method, taking the measurement to these points while avoiding the curvature of the bulb of percussion is not without some difficulties. 

For the Campagne data, we use the following procedure.  All of the flakes were scanned using an Artec surface scanner.  Each of the flake meshes was then landmarked (see @archer_quantifying_nodate for additional details on the scanning and landmarking).  For our purposes, three of these landmarks are important: the two points (left and right) where the interior platform intersects the core surface (i.e., the two ends of the platform width) and the point of percussion.  These three points are analogous with the three points described above for computing the PSIA.  This angle, therefore, can be once again computed using the dot product of these two line segments (specifically the arc-cosine of the dot product of the normalize line segments).  However, there is an important difference in that, with the Dibble glass data, all computations are with two dimensional line segments, while in the Campagne dataset the line segments are in three dimensions.  In the latter case, the angle is computed in a two dimensional plane that is coincident with both line segments, but we note this difference because it could introduce a certain amount of incomparability in the two datasets.  Our expectation is that these angles could average larger than the Dibble glass data because, for instance, lifting the point of percussion relative to the two platform points would result in a larger PSIA.

Lastly, for the MPI data, we use only the goniometer method described above.  One of us (MW) made the measurements with instructions only on the mechanics of the measurement.  To avoid bias, MW was naïve to the goals and results of this study.  In the course of measuring the flakes, several problematic platforms were identified where the measurement of the PSIA was not as clear as the person selecting the flakes (SPM) had initially believed.  These flakes were removed from the analysis.   

We use the R [@r_core_team_r_2018] statistical environment to do this analysis.  This paper is an rMarkdown document, and it is included in the supplementary information along with the data files needed to compile the document and replicate all of the figures, tables, and statistics. 


# Results


```{r estimating_the_PSIA_on_the_Dibble_cores}

# Get the Dibble data
pd = as.vector(dibble$PD)
pw = as.vector(dibble$PW)

# Prepare a place to hold the calculated angle
psia = vector(mode = 'double', length = length(pd))
pd_bulb = vector(mode = 'double', length = length(pd))
pd_edge = vector(mode = 'double', length = length(pd))
max_pop_2_pw = vector(mode = 'double', length = length(pd))

# Work out how many points are on each side of the platform edge outline
mid_point = ceiling((nrow(curve_xy) + 1) / 2)
n_segments = floor(nrow(curve_xy) / 2)

# Now compute the angle for each flake
for (i in (1:length(pd))) {
  
  # First, find the PW on the platform edge outline
  pws = vector('double', n_segments)
  for (n in (1:n_segments)) {
    pws[n] = curve_xy[mid_point + n, 1] - curve_xy[mid_point - n, 1]
  }
  
  # Find the one that best matches our actual PW
  best_match = which(abs(pws - pw[i]) == min(abs(pws - pw[i])))
  
  # Get the coordinates of the left and right edge at this point
  left_edge = curve_xy[mid_point - best_match,]
  right_edge = curve_xy[mid_point + best_match,]
  
  pd_bulb[i] = pd[i] - mean(left_edge[2], right_edge[2])
  pd_edge[i] = mean(left_edge[2], right_edge[2])

  # Make these vectors relative to the origin
  left_edge[2] = left_edge[2] - pd[i]
  right_edge[2] = right_edge[2] - pd[i]
  
  # Add Z = 0 (not needed but lets me use existing code)
  left_edge = matrix(c(left_edge, Z = 0), nrow = 1)
  right_edge = matrix(c(right_edge, Z = 0), nrow = 1)
  
  max_pop_2_pw[i] = max(vector_length(left_edge), vector_length(right_edge))
  
  # Compute the angle
  psia[i] = rad2deg(acos(dot_product(normals(left_edge), normals(right_edge))))
  
}

# Put it back on the data.frame
dibble$psia = psia

# And put these psia angles in with the hand measured artifacts for a later comparison
dibble_remeasured = merge(dibble_remeasured, dibble, by = c('ID')) %>%
  select(psia, psia_trig, PSIA_GONIOMETER)

```



```{r fig3-dibble_psia_histogram, fig.width = 5, fig.height = 2.5, fig.cap = fig_captions[[3]]}

maincolumn_width_theme = theme(text = element_text(size = 10))

p = ggplot(data.frame(psia = psia), aes(psia))
p = p + geom_histogram(breaks = seq(100, 180, by = 5))
p = p + xlab('Platform Surface Interior Angle')
p = p + ylab('Count')
p = p + my_theme
p = p + maincolumn_width_theme

if (tiff_figures) {
    cat('[place Figure 3 here]')
    tiff('figure_03.tif', res = 300, width = 5, height = 2.5, units = 'in') }

p

if (tiff_figures) graphics.off()

```

Figure 3 shows the distribution of estimated PSIA in the Dibble glass dataset.  The distribution has a mean of `r round(mean(psia),2)`±`r round(sd(psia),2)`.  Variation in this angle does not seem to be related to platform depth, exterior platform angle or weight (Figure 4).  There is a relationship between platform width and the platform surface interior angle such that larger angles result in wider platforms, which is to be expected (see Figure 4).  

```{r fig4-psia_to_other_flake_measures, fig.cap = fig_captions[[4]], fig.width = 5}

full_width_theme = theme(text = element_text(size = 6))

plot_data = data.frame(cbind(pd, pw, EPA = dibble$EPA, mass = dibble$WEIGHT,  AOB = dibble$AOB, psia))

p1 = ggplot()
p1 = p1 + geom_point(plot_data, mapping = aes(pd, psia), size = .55, alpha = .5)
p1 = p1 + ylab('PSIA (degrees)')
p1 = p1 + xlab('Platform Depth (mm)')
p1 = p1 + my_theme_smaller_font

p2 = ggplot()
p2 = p2 + geom_point(plot_data, mapping = aes(pw, psia), size = .65, alpha = .5)
p2 = p2 + ylab('')
p2 = p2 + xlab('Platform Width (mm)')
p2 = p2 + my_theme_smaller_font + theme(axis.text.y=element_blank())

p3 = ggplot()
p3 = p3 + geom_point(plot_data, mapping = aes(EPA, psia), size = .75, alpha = .5)
p3 = p3 + ylab('PSIA (degrees)')
p3 = p3 + xlab('EPA (degrees)')
p3 = p3 + my_theme_smaller_font

p4 = ggplot()
p4 = p4 + geom_point(plot_data, mapping = aes(mass, psia), size = .85, alpha = .5)
p4 = p4 + ylab('')
p4 = p4 + xlab('Weight (gm)')
p4 = p4 + my_theme_smaller_font + theme(axis.text.y=element_blank())

if (tiff_figures) {
    cat('[place Figure 4 here]')
    tiff('figure_04.tif', res = 300, width = 5, height = 4, units = 'in') }

grid.arrange(p1, p2, p3, p4, ncol = 2)

if (tiff_figures) graphics.off()

```

There also appears to be a relationship between the angle of blow and the PSIA (Figure 5).  While there are fewer cases with angles of blow less than 20, there is some indication in the data that lower angles of blow may be correlated with lower PSIA.  However, once an angle of blow is between 10-20 degrees or higher, the angle of blow is not correlated with the PSIA.

```{r fig5-AOB_to_PSIA, fig.height = 2.5, fig.width = 4, fig.cap = fig_captions[[5]]}

p = ggplot()
p = p + geom_point(plot_data, mapping = aes(AOB, psia), size = .65, alpha = .65)
p = p + ylab('PSIA (degrees)')
p = p + xlab('AOB (degrees)')
p = p + my_theme

if (tiff_figures) {
    cat('[place Figure 5 here]')
    tiff('figure_05.tif', res = 300, width = 4, height = 2.5, units = 'in') }

p

if (tiff_figures) graphics.off()

```

Another way of looking at the relationship between platform width and PSIA is to calculate what the platform width would be if the PSIA is a constant and compare this to the actual platform width.  We can do this by placing the point of percussion on the same platform outlines as above using the known platform depth for each of the flakes in the Dibble glass data set.  We then use the average PSIA computed above to extend two vectors from this point of percussion to the platform edge.  Where these vectors intersect the platform edge defines the left and right limits of the platform width. This estimated value for platform width is then plotted against the actual, measured platform widths (Figure 6). 

```{r prediction}

pw_estimated = vector('double', length(pd))

mean_psia = mean(psia)
half_mean_psia = mean_psia / 2
upper_angle = 180 + half_mean_psia
lower_angle = 180 - half_mean_psia

for (i in (1:length(pd))) {

  pop = c(0, pd[i])
  
  left_edge = c(pop[1] + 50 * sin(upper_angle * 2 * pi / 360),
                pop[2] + 50 * cos(upper_angle * 2 * pi / 360))
  
  right_edge = c(pop[1] + 40 * sin(lower_angle * 2 * pi / 360),
                pop[2] + 40 * cos(lower_angle * 2 * pi / 360))
  
  for (n in 1:(nrow(curve_xy) - 1)) {
    result = line.line.intersection(pop, left_edge,
                                    curve_xy[n,], curve_xy[n+1,],
                                    interior.only = TRUE)
    if (sum(is.na(result))==0) {
      left_pw = result
      break
    }
  }
  
  for (n in 1:(nrow(curve_xy)-1)) {
    result = line.line.intersection(pop, right_edge,
                                    curve_xy[n,], curve_xy[n+1,],
                                    interior.only = TRUE)
    if (sum(is.na(result))==0) {
      right_pw = result
      break
    }
  }
  
  pw_estimated[i] = sqrt((left_pw[1]-right_pw[1])^2 +
                           (left_pw[2]-right_pw[2])^2)
}

results = data.frame(pd,
                     pw = pw_estimated,
                     DataSet = 'Estimated',
                     stringsAsFactors = FALSE)

```

```{r fig6-pd_pw_with_estimated_pw, fig.height = 2.5, fig.width = 5, fig.cap = fig_captions[[6]]}

plot_data = plot_data %>%
  select(pd, pw) %>%
  mutate(DataSet = 'Actual')

plot_data = rbind(plot_data, results)

p = ggplot(plot_data, aes(pd, pw, color = DataSet))
p = p + geom_point(size = 2, alpha = .5)
p = p + xlab('Platform Depth (mm)')
p = p + ylab('Platform Width (mm)')
p = p + guides(color = guide_legend(title=""))
p = p + scale_color_manual(values = c('#4D95BE', '#E6682D'))
p = p + my_theme

if (tiff_figures) {
    cat('[place Figure 6 here]')
    tiff('figure_06.tif', res = 300, width = 5, height = 2.5, units = 'in') }

p

if (tiff_figures) graphics.off()

```

Figures 7 and 8 show comparisons of the results of the estimated PSIA presented above with direct measurements of this angle on a subsample of `r nrow(dibble_remeasured)` of the `r nrow(dibble)` Dibble glass flakes in our analysis.  For this sample, the PSIA is `r round(mean(dibble_remeasured$psia),2)`±`r round(sd(dibble_remeasured$psia),2)`.  When measured with a digital goniometer the angle is `r round(mean(dibble_remeasured$PSIA_GONIOMETER),2)`±`r round(sd(dibble_remeasured$PSIA_GONIOMETER),2)`, and when measured with digital calipers and calculated using trigonometry the angle is `r round(mean(dibble_remeasured$psia_trig),2)`±`r round(sd(dibble_remeasured$psia_trig),2)`.

```{r fig7_remeasure_comparisons, fig.height = 2, fig.width = 5, fig.cap = fig_captions[[7]]}

p = ggplot(dibble_remeasured, aes(PSIA_GONIOMETER, psia_trig))
p = p + geom_point(size = 1.5, alpha = .5)
p = p + ylab('Caliper PSIA')
p = p + xlab('Goniometer PSIA')
p = p + geom_abline(intercept = 0, slope = 1)
p = p + scale_x_continuous(limits = c(110, 160), breaks = c(110, 130, 150))
p = p + ylim(110, 160)
p = p + coord_fixed()
p = p + my_theme_smaller_font
p1 = p

p = ggplot(dibble_remeasured, aes(PSIA_GONIOMETER, psia))
p = p + geom_point(size = 1.5, alpha = .5)
p = p + ylab('Interpolated PSIA')
p = p + xlab('Goniometer PSIA')
p = p + geom_abline(intercept = 0, slope = 1)
p = p + scale_x_continuous(limits = c(110, 160), breaks = c(110, 130, 150))
p = p + ylim(110, 160)
p = p + coord_fixed()
p = p + my_theme_smaller_font
p2 = p

p = ggplot(dibble_remeasured, aes(psia_trig, psia))
p = p + geom_point(size = 1.5, alpha = .5)
p = p + ylab('Interpolated PSIA')
p = p + xlab('Caliper PSIA')
p = p + geom_abline(intercept = 0, slope = 1)
p = p + scale_x_continuous(limits = c(110, 160), breaks = c(110, 130, 150))
p = p + ylim(110, 160)
p = p + coord_fixed()
p = p + my_theme_smaller_font
p3 = p

if (tiff_figures) {
    cat('[place Figure 7 here]')
    tiff('figure_07.tif', res = 300, width = 6.5, height = 2, units = 'in') }

grid.arrange(p1, p2, p3, ncol = 3)

if (tiff_figures) graphics.off()

```

```{r fig8_remeasure_distributions, fig.height = 2.5, fig.width = 5, fig.cap = fig_captions[[8]]}

p = ggplot(dibble_remeasured, aes(PSIA_GONIOMETER))
p = p + geom_histogram(binwidth = 5)
p = p + xlab('Goniometer PSIA (degrees)')
p = p + ylab('Count')
p = p + scale_y_continuous(limits=c(0, 30)) 
p = p + scale_x_continuous(breaks = seq(120, 170, 10), limits=c(120, 170)) 
p = p + my_theme
p1 = p

p = ggplot(dibble_remeasured, aes(psia_trig))
p = p + geom_histogram(binwidth = 5)
p = p + xlab('Caliper PSIA (degrees)')
p = p + ylab('')
p = p + scale_y_continuous(limits=c(0, 30)) 
p = p + scale_x_continuous(breaks = seq(120, 170, 10), limits=c(120, 170)) 
p = p + my_theme + theme(axis.text.y=element_blank())
p2 = p

if (tiff_figures) {
    cat('[place Figure 8 here]')
    tiff('figure_08.tif', res = 300, width = 6.5, height = 2.5, units = 'in') }

grid.arrange(p1, p2, ncol = 2)

if (tiff_figures) graphics.off()

```

The distribution of the PSIA for the `r nrow(campagne)` flakes in the Campagne dataset is shown in Figure 9.  In the hard hammer flakes only, which is the technique used in our subset of the Dibble glass dataset, the mean platform surface interior angle is `r round(mean(campagne %>% filter(Technique=='Hard Hammer') %>% select(psia) %>% pull()),2)`±`r round(sd(campagne %>% filter(Technique=='Hard Hammer') %>% select(psia) %>% pull()),2)`.  Because data are available for punch and soft hammer flakes, these are presented as well.  Punch flakes have a lower PSIA (`r round(mean(campagne %>% filter(Technique=='Punch') %>% select(psia) %>% pull()),2)`±`r round(sd(campagne %>% filter(Technique=='Punch') %>% select(psia) %>% pull()),2)`), and soft hammer flakes have a mean of `r round(mean(campagne %>% filter(Technique=='Soft Hammer') %>% select(psia) %>% pull()),2)`±`r round(sd(campagne %>% filter(Technique=='Soft Hammer') %>% select(psia) %>% pull()),2)`.  The mean PSIA for all flakes in the Campagne data set is `r round(mean(campagne$psia),2)`±`r round(sd(campagne$psia),2)`. 

```{r fig9-camp_angles, fig.width = 5, fig.height = 2.5, fig.cap = fig_captions[[9]]}

p = ggplot(campagne, aes(psia, fill = Technique))
p = p + geom_histogram(binwidth = 5)
p = p + xlab('PSIA (degrees)')
p = p + ylab('Count')
p = p + scale_fill_manual(values = c('#4D95BE', '#A1BE56', '#E6682D'))
p = p + guides(fill = guide_legend(title=""))
p = p + my_theme

if (tiff_figures) {
    cat('[place Figure 9 here]')
    tiff('figure_09.tif', res = 300, width = 5, height = 2.5, units = 'in') }

p

if (tiff_figures) graphics.off()

```

In the Campagne data, PSIA does not covary with platform width, platform depth or the shape of the platform (as measured by the ratio of platform width to platform depth) (Figure 10).  Though sample size is potentially a problem, there is perhaps an indication that for larger platform depths, there is less variability in the PSIA.

```{r fig10-PSIA_to_other_measures, fig.height = 2, fig.width = 5, fig.cap = fig_captions[[10]]}

p = ggplot(campagne, aes(psia, pw, color = Technique))
p = p + geom_point(show.legend = TRUE, size = .35, alpha = .65)
p = p + xlab('PSIA')
p = p + ylab('Platform Width')
p = p + scale_color_manual(values = c('#4D95BE', '#A1BE56', '#E6682D'))
p = p + guides(color = guide_legend(override.aes = list(size = 3), title = ''))
p1 = p + my_theme_smaller_font

p = ggplot(campagne, aes(psia, pd, color = Technique))
p = p + geom_point(show.legend = TRUE, size = .35, alpha = .65)
p = p + xlab('PSIA')
p = p + ylab('Platform Depth')
p = p + scale_color_manual(values = c('#4D95BE', '#A1BE56', '#E6682D'))
p = p + guides(color = guide_legend(override.aes = list(size = 3), title = ''))
p2 = p + my_theme_smaller_font

p = ggplot(campagne, aes(psia, pw/pd, color = Technique))
p = p + geom_point(show.legend = TRUE, size = .35, alpha = .65)
p = p + xlab('PSIA')
p = p + ylab('PW / PD')
p = p + scale_color_manual(values = c('#4D95BE', '#A1BE56', '#E6682D'))
p = p + guides(color = guide_legend(override.aes = list(size = 3), title = ''))
p3 = p + my_theme_smaller_font

if (tiff_figures) {
    cat('[place Figure 10 here]')
    tiff('figure_10.tif', res = 300, width = 5, height = 2, units = 'in') }

ggarrange(p1, p2, p3, ncol = 3, nrow = 1, common.legend = TRUE, legend = 'bottom')

if (tiff_figures) graphics.off()

```

The distribution of PSIA in the MPI dataset as measured by a digital goniometer is presented in Figure 11.  This dataset contains ```r nrow(MPI_flakes)``` flakes, and the mean is `r round(mean(MPI_flakes$PSIA_GONIOMETER),2)`±`r round(sd(MPI_flakes$PSIA_GONIOMETER),2)`, in keeping with the other datasets.

```{r fig11-mpi_data, fig.height = 2.5, fig.width = 5, fig.cap = fig_captions[[11]]}

p = ggplot(MPI_flakes, aes(PSIA_GONIOMETER))
p = p + geom_histogram(breaks = seq(110, 170, by = 5))
p = p + xlab('Platform Surface Interior Angle (degrees)')
p = p + ylab('Count')
p = p + my_theme

if (tiff_figures) {
    cat('[place Figure 11 here]')
    tiff('figure_11.tif', res = 300, width = 5, height = 2.5, units = 'in') }

p

if (tiff_figures) graphics.off()

```


# Discussion

Each of the datasets and measurement methods used to determine the PSIA yielded very similar results, and these results are consistent with the prediction based on the already known and constant angle of Hertzian cones in soda lime glass (136°).  While these results directly incorporate platform width into the EPA-PD model of flake formation, they also suggest that the existing model requires additional nuance.  All other things being equal, the relationship between PSIA and platform width indicates that what determines the size of the flake is how far into the core it is struck.  Specifically, because of the constant PSIA, the deeper into the core the flake is struck, the greater the platform width will become (and the thicker the flake will become as well).  However, and this is the nuance, while platform depth is normally a good proxy for how far into the core the flake is struck, it is not exactly the same thing.  What platform depth really measures is how far into the *existing platform* of the core the flake is struck.  Beveled flakes illustrate this point.

```{r figmore_modeling, comment = NA}

model_pd = lm(pd ~ psia + pw)

bevel_flakes = dibble_inc_bevel %>%
  filter(BEVEL!= 'NONE') %>%
  mutate(WEIGHT_CR = WEIGHT ^ (1/3)) %>%
  select(pw = PW, EPA, WEIGHT_CR , PD, LENGTH) %>%
  mutate(psia = mean_psia) %>%
  mutate(PD_true = PD)
bevel_flakes$PW = bevel_flakes$pw

estimated_pd = predict(model_pd, data.frame(bevel_flakes))

bevel_flakes$PD = estimated_pd

dibble$WEIGHT_CR = dibble$WEIGHT ^ (1/3)

model_mass =  lm(WEIGHT_CR ~ PD + EPA + PD * EPA, data = dibble)
dibble$model_weight = predict(model_mass, data = dibble)

bevel_flakes$estimate_weight2 = predict(model_mass, data.frame(bevel_flakes))

bevel_flakes$PD = bevel_flakes$PD_true
bevel_flakes$estimate_weight1 = predict(model_mass, data.frame(bevel_flakes))

bevel_flakes$PD = estimated_pd

```

Beveled flakes are ones where material is removed behind the platform prior to striking the core.  Dibble and colleagues recognized that beveling altered the EPA-PD model of flake formation such that the interaction of platform depth and exterior platform angle no longer predicted flake size [@leader_effects_2017].  Beveled flakes have too thin a platform for their size.  However, PSIA helps explain this discrepancy and thereby pulls beveled flakes back into an expanded EPA-PD model.  To illustrate this point, we examine some beveled flakes in the Dibble glass dataset.

In the Dibble glass dataset there are `r nrow(bevel_flakes)` flakes with flat or concave beveling, coming from semispherical cores, and otherwise conforming to our selection criteria.  These are plotted in Figure 12 along with the non-beveled flakes.  It is clear that beveling changes the relationship between platform depth and platform width.  For a given platform width, the beveled flakes have much shallower platforms (smaller PD) than expected.  As a result, the EPA-PD model underestimates their weight (see Figure 12) as well.  To illustrate the power of PSIA to model these flakes, we build a linear model to estimate platform depth from the PSIA and platform width in the non-beveled flakes in the Dibble glass dataset.  We then use this model to predict a platform depth for the beveled flakes.  However, given that the linear model requires PSIA to predict platform depth and the actual PSIA is not known for these flakes, we substitute in its place the average PSIA, as reported above for the non-beveled flakes.  When this is done, the predicted platform depths for the beveled flakes plot on the same trend line as the non-beveled flakes (compare red and blue points in Figure 12).  

This modeled platform depth is then be used to improve the EPA-PD model to give better estimates of flake size.  The main aspect of size that Dibble and colleagues have focused on with the EPA-PD model is weight, and so we model flake weight as a function of EPA, platform depth and the interaction of the two (see Figure 12).  The cube root of weight is used to correct for the different dimensions in the model.  Next, we use this same model to predict flake weight in the beveled flakes using the platform depth as originally measured on these beveled flakes.  In this case, the modeled flake weights are much too low in comparison to their actual weights (red points in Figure 12).  Finally, we use the predicted platform depth for the beveled flakes, as modeled above, to predict flake weight again using the non-beveled flake model.  In this case, the flake weights plot in among the rest of the non-beveled flakes (blue points in Figure 12).  Thus the beveled flakes are the expected size when we think of PD in the EPA-PD model not as a measure of platform depth but rather as a measure of how far into the core the flake is struck, which then determines the flake width via the PSIA given the shape of the platform edge.  Beveling does not change the expected size of these flakes when flake formation is viewed this way.

```{r fig12-bevel_with_estimated_pd, fig.width = 5, fig.height = 5, fig.cap = fig_captions[[12]]}

p = ggplot(dibble_inc_bevel, aes(PD, PW, color = Beveling))
p = p + geom_point(alpha = .5)
p = p + geom_point(bevel_flakes, mapping = aes(PD, PW, color = 'Estimated'), size = 2, alpha = .65)
p = p + xlab('Platform Depth (mm)')
p = p + ylab('Platform Width (mm)')
p = p + my_theme
p1 = p + scale_colour_manual(name = "Beveling",
                            values = c('Beveled' =  '#E6682D', 'None' = 'black', 'Estimated' = '#4D95BE'))

p = ggplot(dibble, aes(x = WEIGHT_CR, y = model_weight))
p = p + geom_point(alpha = .5)
p = p + geom_point(data = bevel_flakes, mapping = aes(x = WEIGHT_CR, y = estimate_weight1, color = 'w/o PSIA'),
                    size = 2, alpha = .65)
p = p + geom_point(data = bevel_flakes, mapping = aes(x = WEIGHT_CR, y = estimate_weight2, color = 'with PSIA'),
                    size = 2, alpha = .65)
p = p + xlab('Actual Flake Weight')
p = p + ylab('Modeled Flake Weight')
p = p + my_theme
p2 = p + scale_colour_manual(name = "Beveled\nFlakes",
                            values = c('w/o PSIA' = '#E6682D', 'with PSIA' = '#4D95BE'))

if (tiff_figures) {
    cat('[place Figure 12 here]')
    tiff('figure_12.tif', res = 300, width = 5, height = 5, units = 'in') }

grid.arrange(p1, p2, ncol = 1)

if (tiff_figures) graphics.off()

```

There is some indication in the Dibble glass data that the angle of blow may impact the PSIA.  As mentioend earlier, at low angles of blow (with 0 degrees representing an angle of blow perpendicular to the platform, see Figure 2 in @magnani_flake_2014-1), the PSIA is below average, and it appears to increase until the angle of blow reaches between 10 and 20 degrees (from perpendicular) after which the PSIA remains essentially unchanged (see Figure 5).  With the caveat that the Dibble glass data set has very few cases with angles of less than 20 degrees, the fracture mechanics literature suggests a relationship like this: the angle of blow changes the direction, though not the size, of the Hertzian cone such that flakes struck from cores with a high angle of blow (oblique strike) should have "steeper and less prominent cones and less salient bulbs of percussion than flakes which are struck more steeply [or more perpendicular]" ([@speth_mechanical_1972], page 38).  Experimentally, Magnani et al. [@magnani_flake_2014-1] also find a relationship between these variables.  In their case, a negative angle of blow (here values less than 0 meaning a strike directed into the interior of the core rather than towards the core surface) results in smaller bulbs relative to the weight of the flake.  In our Campagne data set, we see a difference between flakes made from direct hard-hammer percussion and those made with a punch technique.  The latter cluster at the low range of PSIA.  This difference could be interpreted as reflecting a difference in the angle of blow in that punch flakes are more likely to be struck perpendicularly to the platform surface (an angle of blow of 0).  More work needs to be done, in particular in analyzing the Dibble glass data set where angle of blow is well controlled, but we suggest that increasing the angle of blow has the effect of tipping the direction of the Hertzian cone such that it intersects the core surface not as a circle but rather as an ellipse.  This is a phenomenon that has been repeatedly documented in fracture mechanics [@chaudhri_dynamic_2015; @chen_influence_1989; @lawn_computer_1974].  Although the angle of the cone itself remains unchanged, its intersection with the surface broadens and results in higher PSIA.  Thus, if this suggestion is correct, striking a core with a high angle of blow will result in a larger platform width for a given platform thickness. 

The direct measurement of PSIA in a subsample of the Dibble glass flakes shows that our method for finding this angle using the platform surface shape and platform depth is working.  However, there is variability in this angle depending on how it is measured.  With the caveats that only one person measured these flakes and that the sample is small, in general it seems that the direct measurement with a goniometer performs better than the indirect calculation of the angle from three caliper measurements.  Of the two methods, the caliper measurements show greater variability than do the goniometer measurements.  The caliper method can also fail completely when measurement error produces a triangle with impossible side lengths (e.g. the sum of the two shorter sides is less than the length of the longest side).  Importantly too, this is only knowable once the measures are taken and an angle is calculated, making it much more difficult to correct, whereas the goniometer method produces an angle each time.  Our study, however, does not indicate which of the three methods in this case is correct, nor do we know the error associated with any of these individual methods.  Now that PSIA seems to produce results relevant to understanding flake formation, additional studies are required to better know the error distribution on an individual measure.  We note too that this error distribution will likely vary with the angle itself, the size of the point of percussion, and other factors that remain to be identified.  The question, however, is whether this measurement error will overwhelm patterns, such as, for instance, showing a potential correlation in angle of blow and PSIA.  It is our expectation that with a digital goniometer, direct measurement of the PSIA can become one of the standard measurements within lithic attribute analysis, but this remains to be determined.

We note that our finding that the PSIA varies around a constant derived from fracture mechanics appears to be consistent with all of the findings to date of the Dibble glass experiments [@dibble_introducing_2009-1; @leader_effects_2017; @lin_utility_2013-1; @magnani_flake_2014-1; @rezek_relative_2011-1].  Additionally, it perhaps helps explain or account for one of the more counter-intuitive findings of the glass experiments, namely that flake size (weight) is not impacted by the force with which the core is struck [@dibble_introducing_2009-1].  In the EPA-PD model, the amount of force required to remove a flake given a particular combination of EPA-PD is a constant (see also @chai_edge_2007).  Subtracting force means that the flake is not initiated.  Adding force does not change the size of the resulting flake.  This makes sense in the PSIA addition to the model.  In fracture mechanics, it is known that striking a material harder will change the size of the Hertzian cone but not the angle [@kocer_angle_1998].  Thus when a given core is struck, how far into the core the Hertzian cone can travel will depend on the hammer size and the striking force, but where the cone will intersect the core surface does not change.  So striking a Dibble glass core harder at a particular point does not change the platform width, and as a result, the subsequent fracture plane that removes the flake has much less freedom to change the size of the flake.  This said, we note that a recent study @chaudhri_dynamic_2015 shows that increasing impact velocity of the indenter will eventually cause the Hertzian cone angle to decrease (see also @wang_comparative_2017).  The question is whether these velocities are relevant to stone knapping. 




# Conclusions

Fracture mechanics is a massive field of study with both great potential and great difficulties for understanding flake formation.  The potential is that the physical laws and models coming from fracture mechanics are, ultimately, how the actions of knappers are translated to the removal of usable flakes.  The difficulties are both inherent to the field of fracture mechanics itself and to the complexity of the problem (some solutions require more time and computing power than exists).  There are also difficulties related to the challenges of interdisciplinary work where the equations and goals of one field are terribly difficult to bring into another.  This later point is clearly seen in the early fracture mechanics literature and the minimal impact it has had on experimental and replicative studies of flake formation.

This said, our goal here was to return to this literature and to try to find some useful insights that could be translated to a better understanding of the underlying mechanisms (or first principles) of flake formation and that might thereby lead to a better integration of the various statistical models currently in use.  To do this, we switched from the existing focus in the experimental literature on what knappers do to instead focus on attributes that may be more directly related to fracture mechanics.  Thus we focused our attention on the Hertzian percussion cone as a constant and investigated whether it could help explain platform width, an aspect of flake size and shape that up to now has been absent from the dominant EPA-PD model of flake formation.  We measured three different collections in multiple different ways and found that in each case the angle formed by the platform width and the point of percussion to be, on average, essentially the same as what is predicted from fracture mechanics for the angle of the Hertzian cone. 

We conclude that the platform surface interior angle or PSIA is an important determinant in flake size and shape.  While it would seem that it is a constant and not under direct control by the knapper, the knapper is (unknowingly) exploiting the properties of this angle when preparing the platform and its contact with the core surface and when deciding how far into the core to strike.  In fact, this angle underlies a knapper's ability to visualize the extent of the striking platform prior to removing a flake.  In our model, this is how the PD side of the EPA-PD model of flake formation is translated into a flake of a particular size and shape.  In other words, it is not the PD that directly structures flake size but rather PD is proxy for how far into the core a flake is struck which then, through the effect of platform surface interior angle on platform width, structures the size and shape of the flake.

This, however, requires further testing, particularly with beveled flakes where PD, without PSIA, performs poorly as a proxy for how far into the core a flake is struck.  If the PSIA performs better in these circumstances, as the preliminary data presented here suggest (see Figure 11), then we will have improved the EPA-PD model and helped to integrate what are now disparate studies [@dibble_introducing_2009-1; @leader_effects_2017].  Additionally, while our study shows that the average PSIA conforms well to predictions from fracture mechanics for Hertzian flake formation, it is still clear that there is variability around this mean.  Given that there is certainly some chaos in flake formation, we are not sure how much variability to expect.  For instance, sometimes the Hertzian cone crack may kink at a light angle to continue expanding, and this kink may contribute to the variability observed in PSIA [@hu_hertzian_1996; @marimuthu_spherical_2016].  However, it is also clear that the model does not work at all for some flakes.  It may be the case that these flakes are not formed by Hertzian mechanisms (e.g. bending flakes) and that alternative models will be required in these cases. Clearly more experiments and more data are required to begin to understand which kinds of flakes fail the PSIA model presented here, and these flakes will require additional insights into models of flake formation.



# Acknowledgements

Michel Brenet and Laurence Bourguignon produced the Campagne data set, and we thank them for allowing us access to this important collection.  Claudio Tennie provided feedback on the ideas and comments on the manuscript.  SPM, MW, WA, ZR and TD thank Jean-Jacques Hublin for his continued support of our research agenda.  Sadly Harold Dibble died before the main findings of this paper were discovered.  Without his vision and his efforts to build a data set of flakes made under controlled conditions, this paper would not have been possible.  We dedicate this paper to him.



# Permits

No permits were required for the described study, which complied with all relevant regulations.



# Supplemental Information

**S1 File.  PSIA_manuscript.rmd.**  rMarkdown file of this document.

**S2 File.  datasets.zip.**  Compressed file containing data files, figures, bibliography and format file.


```{r results = 'asis'}

if (tiff_figures) {
  cat('# Figures  \n')
  for (i in 1:length(fig_captions)) {
    cat("**Figure ",i,"**.  ", fig_captions[[i]],"  \n", sep = '')
  }
}

```

# References




