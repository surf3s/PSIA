---
title: "PW, PD and PSIA"
author: "McPherron"
date: "`r Sys.Date()`"
output: tint::tintPdf
---

```{r setup, include=FALSE}
library(tint)
# invalidate cache when the package version changes
knitr::opts_chunk$set(tidy = FALSE, cache.extra = packageVersion('tint'), echo = FALSE, warning = FALSE, message = FALSE, comment = NA)
options(htmltools.dir.version = FALSE)

library(tidyverse)

my_theme = theme_minimal()
my_theme = my_theme + theme(panel.grid.minor = element_blank())
my_theme = my_theme + theme(panel.grid.major.x = element_blank())

```

There has been some concern about PSIA that it is driven by platform width (instead of the other way around) or that it was a simple math trick (note I have had these concerns all along as well in my skeptical moments).  The other day though I thought of a way to maybe explain why this is not the case a bit better.  

```{r}

rad2deg = function(angles) return(angles / pi * 180)

piv = readRDS('../piv analysis/data/piv.rds') %>%
  filter(PLATSURF == 'PLAIN') %>%
  mutate(PW = PLATWIDTH) %>%
  mutate(PD = PLATTHICK) %>%
  filter(!is.na(PW) & !is.na(PD)) %>%
  select(PD, PW) %>%
  mutate(LPW = sqrt(PD ^ 2 + (PW / 2) ^ 2)) %>%
  mutate(psia_faux = rad2deg(acos((LPW ^ 2 + LPW ^ 2 - PW ^ 2) / (2 * LPW * LPW))))

```

What I do here is call up the data from Pech IV, filter it by flakes with plain platforms and valid measurements on platform width and platform depth  (N = `r nrow(piv)`).  Here are what those data look like.  There is, of course, a relationship between PD and PW.  One predicts the other.


```{r, fig.cap = 'Platform depth vs. platform with in PIV flakes with plain platforms.'}

p = ggplot(piv, aes(x = PD, y = PW))
p = p + geom_point(alpha = .1)
p = p + geom_smooth(method = 'lm', color = 'steelblue2')
p = p + my_theme
p

```

Now let's imagine that PSIA is the triangle formed by platform depth and width (it is not this but let's imagine it is).  We can then calculate the a faux PSIA based on this (see histogram).  As expected there is a normal distribution and the mean (`r round(mean(piv$psia_faux),2)`) is less than what we expect for PSIA.  This is because PD is larger than the proper PSIA triangle and this then narrows the angle.

The faux PSIA here is a function of the slope of the regression line of PD to PW.  A steeper line would raise this angle, and a flatter line would lower it.  The variability in this histrogram is a function of the variability in the above scatter plot.  So, I think this is a nice demonstration of how PSIA explains PW and of why PD and PW are related (though imperfectly - remember I think PD is not the right measure).

To my knowledge, no one has ever before explained why PD and PW should be related, and no one has ever converted these relationships to angles.

```{r fig.cap = 'Distribution of faux PSIA based on PD and PW.'}

p = ggplot(piv, aes(psia_faux))
p = p + geom_histogram(breaks = seq(0, 180, by = 5))
p = p + xlab('Faux Platform Surface Interior Angle')
p = p + ylab('Count')
p = p + my_theme
p

```


